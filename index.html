<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/style.css">
    
    <title>Todo</title>
</head>
<body>
    <div class="heading" >
        <p>To-Do for you!</p>
    </div>
    <div class="boxes-container" >
        <p>Tasks to complete</p>
        <p class="hiddenText">No tasks right now!!</p>
        <div class="box" >
            <div class="description">
                <div class="round"></div>
                <p id="descriptionPara"></p>
            </div>
            <div class="controls">
                <input type="checkbox" name="isDone" id="isDone" value="false">
                <div class="cancel"></div>
            </div>
        </div>
    </div>
    <div class="new-todo_container" >
        <!-- <div class="title-container">
            <p>Title</p>
            <input type="text" name="titlebox" id="">
        </div> -->
        <!-- <div class="task-container"> -->
            <p>Add new task!</p>
            <textarea name="taskbox" id="taskbox" cols="30" rows="10"></textarea>
            <button class="submit" id="submit">Add</button>
            <!-- <input type="text" name="taskbox" id=""> -->
        <!-- </div> -->
        <!-- <div class="add-button">+</div> -->
    </div>
    <script>
        let tasks = [];


        const getTaskContent = () => {
            const taskbox = document.getElementById("taskbox");
            tasks.push({"task":taskbox.value,"status":"incomplete"});
            checkArray();

        }

        const addBox = (text) => {
            let originalBox = document.getElementsByClassName("box")[0];
            let cloneBox = originalBox.cloneNode(true); //true for producing deep clone
            cloneBox.querySelector("#descriptionPara").textContent=text;
            document.getElementsByClassName("boxes-container")[0].appendChild(cloneBox);

        }

        

        let isDone = document.getElementById("isDone");
        
        isDone.addEventListener("change",()=>{
            if(isDone.checked){
                let currentTask = document.getElementById("descriptionPara");
                let index = tasks.findIndex( (taskObject) => {
                    return taskObject.task === currentTask.textContent;
                });
                if(index !== -1) tasks[index].status = "complete";
                else console.log("Task not found!");
            }
        })

        let box = document.getElementsByClassName("box")[0];
        let emptyText = document.getElementsByClassName("hiddenText")[0];
        const checkArray = () => {
            if(tasks.length==0)
            {
                emptyText.style.removeProperty("display");
                box.style.display="none";
            } 
            else{
    
                    // let box = document.getElementsByClassName("box")[0];
                    // box.style.display="none";
                    emptyText.style.display="none";
                    box.style.removeProperty("display");
                    // let emptyText = document.getElementsByClassName("hiddenText")[0];
                    // emptyText.style.display="none";
                    let toDoDescription = document.getElementsByClassName("description")[0];
                    console.log(toDoDescription);
                    let descriptionPara = toDoDescription.querySelector("#descriptionPara"); 
                    //to modify a child's content using parent element
                    console.log(tasks[0])
                    descriptionPara.textContent=tasks[0].task;
                    console.log(tasks)

                    tasks.slice(1).map((value)=>{
                        
                        addBox(value.task);
                    });
            }

        }

        checkArray();
        
        const button = document.getElementById("submit");
        console.log(button);
        button.addEventListener("click",getTaskContent); 

    </script>
</body>
</html>